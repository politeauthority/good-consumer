<div class="row">
  <div class="col-lg-12">
    <h1>{{ d['company']['name'] }}</h1>
    <ol class="breadcrumb">
      <li><a href="index.html"><i class="icon-dashboard"></i> Companies</a></li>
      <li>{{ d['company']['name'] }}</li>
    </ol>
  </div>
</div><!-- /.row -->

<!-- Primary Info -->
<div class="col-lg-6">
  <h2>Primary Info</h2>
  <a href="#" id="edit_btn">edit</a>
  <div class="table-responsive">
    <table class="table table-hover table-striped tablesorter">
      <tbody>
        <tr>
          <td><b>Name</b></td>
          <td>
            <span class="edit_text">{{ d['company']['name'] }}</span>
            <input class="form-control edit_input" style="display:none;" name="name" value="{{ d['company']['name'] }}">
            <input class="edit_input" type="hidden" name="company_id" value="{{ d['company']['company_id'] }}">
          </td>
          <td></td>
        </tr>
        <tr>
          <td><b>Slug</b></td>
          <td>
            <span class="edit_text">{{ d['company']['slug'] }}</span>
            <input class="form-control edit_input" style="display:none;" name="slug" value="{{ d['company']['slug'] }}">
          </td>
          <td></td>
        </tr>
        <tr>
          <td><b>Headquarters</b></td>
          <td>
            {% if d['company']['headquarters'] %}
              {{ d['company']['headquarters'] }}
            {% endif %}
          </td>
          <td></td>
        <tr>
          <td><b>Founded</b></td>
          <td>
            {% if['company']['founded'] %}
              {{ d['company']['founded'] }}
            {% endif %}            
          </td>
          <td></td>
        </tr>
        <tr>
          <td><b>Wikipedia</b></td>
          <td>
            <a href="{{ d['company']['wikipedia'] }}" target="wikipedia">{{ d['company']['wikipedia'] }}</a>
          </td>
          <td></td>
        </tr> 
      </tbody>
    </table>
  </div>
</div>

<!-- Company People -->
{% if d['company']['meta']['people'] %}
  <div class="col-lg-6">
    <h2>People</h2>
    <div class="table-responsive">
      <table class="table table-hover table-striped tablesorter">
        <thead>
          <tr>
            <th class="header">Company</th>
            <th class="header">Updated</th>
          </tr>
        </thead>
        <tbody>
          {% for person in d['company']['meta']['people'] %}
            <tr>
              <td>{{ person['name'] }}</td>
              <td></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endif %}

<!-- Internal Resources -->
<div class="col-lg-6">
  <h2>Internal Resources</h2>
  <div class="table-responsive">
    <ul>
      <li><a href="/info/{{ d['company']['slug'] }}" target="good_consumer_public">Good Consumer Public</a></li>
      <li><a href="{{ d['company']['wikipedia'] }}" target="wikpedia">Wikipedia</a></li>
    </ul>
  </div>
</div>

{% if  d['news'] %}
  <!-- Company News -->
  <div class="col-lg-12">
    <h2>News</h2>
    <div class="table-responsive">
      <table class="table table-hover table-striped tablesorter">
        <tbody>
          {% for news in d['news'] %}
            <tr>
              <td><b>{{ news['headline'] }}</b></td>
              <td></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    </div>
  </div>
{% endif %}

<!-- All Company Meta -->
<div class="col-lg-12">
  <h2>All Meta</h2>
  <div class="table-responsive">
    <table class="table table-hover table-striped tablesorter">
      <thead>
        <tr>
          <th class="header">Meta Key</th>
          <th class="header">Meta Value</th>
        </tr>
      </thead>
      <tbody>
        {% for meta in d['company']['meta'] %}
          <tr>
            <td><b>{{ d['meta_value'] }}<p></td>
            <td>{{ d['meta_key'] }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div id="edit_submit">
  <a href="#" id="cancel_btn" class="btn btn-default">Cancel</a>
  <a href="#" id="save_btn" class="btn btn-default">Save</a>
</div>

<style type="text/css">
  #edit_submit{
    display: none;
  }
</style>

<script type="text/javascript">
  $( document ).ready(function() {

    // Edit Button
    $('#edit_btn').click( function(){
      $('.edit_text').toggle();
      $('.edit_input').toggle();
      $('#edit_submit').toggle();
    });

    // Cancel
    $('#cancel_btn').click( function(){
      $('.edit_text').toggle();
      $('.edit_input').toggle();
      $('#edit_submit').toggle();
    });    
    
    //Save Button
    $('#save_btn').click( function() {
      edit_type = 'company';
      data = {}
      $('.edit_input').each( function() {
        data[ $(this).attr('name') ] = $(this).attr('value');
      });
      console.log( data );
      $.ajax({
        type : 'POST',
        url  : '/admin/edit_ajax/' + edit_type,
        data : data,
        success: function( result ){
          alert( result );
          $('.edit_text').toggle();
          $('.edit_input').toggle();
          $('#edit_submit').toggle();          
        }
      });
    });

  });
</script>
